{% extends "base.jinja" %}
{% block content %}
    <div class="center">
        <h2>{{ ftl_get_message("banner-management-title") }}</h2>
        <p>{{ ftl_get_message("banner-management-description") }}</p>

        {% if banners|length == 0 %}
            <p>{{ ftl_get_message("banner-management-no-banners") }}</p>
            <a href="/banners/draw">{{ ftl_get_message("banner-management-create-first") }}</a>
        {% else %}
            <div class="banner-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                {% for banner_tuple in banners %}
                    {% set banner = banner_tuple[0] %}
                    {% set image_url = banner_tuple[1] %}
                    <div class="banner-item" style="border: 1px solid #ccc; padding: 0.5rem; border-radius: 4px; {% if banner.is_active %}background-color: #e8f5e9;{% endif %}">
                        <img src="{{ image_url }}" alt="Banner" style="width: 100%; height: auto; display: block;">
                        <div style="margin-top: 0.5rem;">
                            <div style="font-size: 0.875rem; color: #666;">
                                {{ ftl_get_message("banner-management-created") }}: {{ banner.created_at.format("%Y-%m-%d %H:%M") }}
                            </div>
                            {% if banner.is_active %}
                                <div style="font-weight: bold; color: #2e7d32; margin-top: 0.25rem;">
                                    {{ ftl_get_message("banner-management-active-badge") }}
                                </div>
                            {% else %}
                                <button hx-post="/banners/{{ banner.id }}/activate"
                                        hx-swap="none"
                                        hx-on::after-request="window.location.reload()"
                                        style="margin-top: 0.5rem; width: 100%;">
                                    {{ ftl_get_message("banner-management-set-active") }}
                                </button>
                                <button hx-delete="/banners/{{ banner.id }}"
                                        hx-confirm="{{ ftl_get_message("banner-management-delete-confirm") }}"
                                        hx-swap="none"
                                        hx-on::after-request="window.location.reload()"
                                        style="margin-top: 0.25rem; width: 100%; background-color: #d32f2f; color: white;">
                                    {{ ftl_get_message("banner-management-delete") }}
                                </button>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>

            <div style="margin-top: 2rem;">
                <a href="/banners/draw">{{ ftl_get_message("banner-management-create-new") }}</a>
            </div>
        {% endif %}

        <div style="margin-top: 2rem;">
            <a href="/@{{ user.login_name }}/settings">{{ ftl_get_message("banner-management-back-to-settings") }}</a>
        </div>
    </div>
{% endblock content %}
