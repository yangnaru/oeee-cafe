{% import "comments_macro.html" as comments_macro %}
{% extends "base.html" %}
{% block title %}
  {{ super() }} |
  {% if post.title %}
    {{ post.title }}
  {% else %}
    {{ ftl_post_no_title }}
  {% endif %}
{% endblock title %}
{% block head %}
  <meta property="og:title" content="{{ post.title }}" />
  <meta property="og:description" content="{{ post.content }}" />
  <meta property="og:type" content="website" />
  <meta property="og:url"
        content="{{ base_url }}/posts/{{ encoded_post_id }}" />
  <meta property="og:image"
        content="{{ r2_public_endpoint_url }}/image/{{ post.image_filename[:2] }}/{{ post.image_filename }}" />
{% endblock head %}
{% block body %}
  <div class="center">
    <div class="post-sidebar">
      <div class="post-main">
        <p>{{ ftl_post_published_at }}: {{ post.published_at }}</p>
        <p>
          {{ ftl_post_duration }}: {{ post.paint_duration }}
          <a href="/posts/{{ encoded_post_id }}/replay">{{ ftl_post_replay }}</a>
        </p>
        <p>HIT: {{ post.viewer_count }}</p>
        <p>
          {{ ftl_community }}:
          <a href="/communities/{{ encoded_community_id }}">{{ post.community_name }}</a>
        </p>
        <img class="post-image"
             width="{{ post.image_width }}"
             height="{{ post.image_height }}"
             alt="{{ post.title }}"
             src="{{ r2_public_endpoint_url }}/image/{{ post.image_filename[:2] }}/{{ post.image_filename }}" />
        <div class="center">
          <p>
            {{ ftl_post_author }}: <a href="/@{{ post.login_name }}">{{ post.display_name }}</a> <span class="muted">@{{ post.login_name }}</span>
          </p>
          <p>
            {{ ftl_post_title }}:
            {% if post.title %}
              {{ post.title }}
            {% else %}
              {{ ftl_post_no_title }}
            {% endif %}
          </p>
          <p>
            {{ ftl_post_description }}: <pre>{{ post.content }}</pre>
          </p>
          <a href="https://twitter.com/share?ref_src=twsrc%5Etfw"
             class="twitter-share-button"
             data-via="oeee_cafe"
             data-hashtags="오이카페"
             data-related="oeee_cafe"
             data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
      </div>
      <div class="post-comments">
        <h2>{{ ftl_post_comments }}</h2>
        <form hx-post="/comments" hx-swap="outerHTML">
          <input type="hidden" name="post_id" value="{{ encoded_post_id }}">
          <textarea name="content"></textarea>
          <button type="submit">{{ ftl_post_comment }}</button>
        </form>
        {% if comments %}{{ comments_macro.comments(comments) }}{% endif %}
      </div>
    </div>
  </div>
{% endblock body %}
